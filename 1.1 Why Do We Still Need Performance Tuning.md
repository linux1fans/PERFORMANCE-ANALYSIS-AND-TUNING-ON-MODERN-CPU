当寻求提高性能的方法时，开发人员不应依赖硬件。相反，他们应该开始优化他们的应用程序代码。

"如今的软件效率极低；现在是软件程序员真正擅长优化的黄金时代。" - Marc Andreessen，美国企业家和投资者（a16z Podcast，2020）

**个人经历：** 在英特尔工作期间，我不时听到同样的故事：当英特尔的客户在他们的应用程序中遇到速度缓慢的问题时，他们会立即无意识地将责任归咎于英特尔的CPU速度慢。
但是，当英特尔派遣我们的性能专家与他们合作，帮助他们改进应用程序时，他们通常可以将其加速5倍，有时甚至是10倍。

达到高水平的性能是具有挑战性的，并且通常需要大量的努力，但希望本书能为您提供工具来帮助您实现这一目标。

## 1.1 为什么我们仍然需要性能调优？

现代CPU每年都在增加越来越多的核心。截至2019年底，您可以购买一款高端服务器处理器，它将拥有100个以上的逻辑核心。这非常令人印象深刻，但这并不意味着我们不再需要关注性能。很多时候，应用程序的性能可能不会随着CPU核心数量的增加而提升。典型的通用多线程应用程序的性能并不总是与分配给任务的CPU核心数量成正比。了解为什么会出现这种情况以及可能的解决方法对于产品的未来增长至关重要。无法进行适当的性能分析和调优会导致性能和资金的浪费，并可能导致产品的失败。

根据[Leiserson等人，2020]的研究，在短期内，大部分应用程序的性能提升将源自于软件堆栈。可悲的是，应用程序并不会自动获得最佳性能。文章[Leiserson等人，2020]还提供了一个很好的例子，说明在源代码级别上可以进行的性能改进潜力。表1总结了一个在一个双插槽的Intel Xeon E5-2666 v3系统上运行的，用于乘法计算两个4096×4096矩阵的程序的加速比。通过应用多个优化，最终得到的程序运行速度提高了超过60000倍。提供这个例子的目的不是针对Python或Java（它们都是很好的语言），而是打破对软件默认具有“足够好”的性能的观念。


** 表1：** 通过对一个在具有60GB内存的双插槽Intel Xeon E5-2666 v3系统上运行的，计算两个4096×4096矩阵的程序进行性能工程的加速比。

|   版本   |     实现方式      | 绝对加速比 | 相对加速比 |
|:-------:|:-----------------:|:----------:|:----------:|
|    1    |      Python       |     1      |     —      |
|    2    |      Java 11      |    11      |   10.8     |
|    3    |         C         |     47     |    4.4     |
|    4    |    并行循环       |    366     |    7.8     |
|    5    |    并行分治       |   6,727    |    18.4    |


