衡量你是否达到目标。 您可以在 [Gregg, 2013] 和 [Akinshin, 2019] 中阅读有关设置性能目标主题的更多信息。
尽管如此，练习和掌握性能分析和调优的技能总是很棒的。 如果您因为这个原因拿起这本书，我们非常欢迎您继续阅读。

### 1.3 什么是性能分析？

是否曾经与同事就某段代码的性能进行辩论？那么您可能知道预测哪段代码效果最好是多么困难。在现代处理器中有如此多的移动部件，即使对代码进行微小的调整也可能引发显著的性能变化。这就是为什么本书的第一个建议是：始终进行测量。

**个人经验：**我看到很多人在优化应用程序时依赖直觉。通常情况下，这只会导致随机修复而对应用程序的性能没有任何真正的影响。

经验不足的开发人员经常在源代码中进行更改，并希望能改善程序的性能。一个例子是在代码库中到处替换`i++`为`++i`，假设之前的`i`值未被使用。一般情况下，这种更改对生成的代码没有任何影响，因为任何合理的优化编译器都会识别出之前的`i`值未被使用，并消除冗余的副本。
在过去，世界上流传着许多微观优化的技巧，但当前的编译器已经学会了它们。此外，一些人倾向于过度使用过时的位操作技巧。其中一个例子是使用基于XOR的交换惯用语法[^17]，而实际上，简单的`std::swap`会产生更快的代码。这种意外的更改可能不会改善应用程序的性能。找到正确的修复位置应该是经过仔细性能分析的结果，而不是凭直觉和猜测。

有许多性能分析方法论[^18]，可能会或可能不会带领您做出发现。本书介绍的针对特定CPU的性能分析方法有一个共同点：它们都基于收集有关程序执行方式的特定信息。对程序源代码所做的任何更改都是通过分析和解释收集的数据驱动的。

找到性能瓶颈只是工程师工作的一半。第二个部分是正确地修复它。有时候只需更改程序源代码中的一行就能显著提升性能。性能分析和调优的关键在于如何找到并修复这行代码。错过这样的机会可能是一种巨大的浪费。

### 1.4 本书讨论了什么？

本书旨在帮助开发人员更好地了解他们的应用程序的性能，学会发现低效率，并消除它们。为什么我手写的存档程序的速度比常规存档程序慢两倍？为什么我的函数更改导致性能下降两倍？用户抱怨我的应用程序运行缓慢，而我不知道从哪里开始？我是否将程序优化到了极致？我该怎么办

[^17]: XOR-based swap idiom - [https://en.wikipedia.org/wiki/XOR_swap_algorithm](https://en.wikipedia.org/wiki/XOR_swap_algorithm)

[^18]: B. Gregg的性能分析方法论 - [http://www.brendangregg.com/methodology.html](http://www.brendangregg.com/methodology.html)
