广义上说，软件堆栈包括许多层，例如固件、BIOS、操作系统、库以及应用程序的源代码。但由于大多数较低层的软件不在我们的直接控制之下，我们主要关注的是源代码。另一个重要的软件组件是编译器。通过给编译器提供各种提示，可以实现所需的机器码生成，从而获得令人满意的加速效果。在本书中，你将会找到许多这样的例子。

> **个人经验：** 要成功地实现应用程序所需的改进，并不需要成为编译器专家。根据我的经验，至少有90%的转换可以在源代码层面完成，而不需要深入研究编译器源代码。然而，了解编译器的工作原理以及如何使其按照你的意愿运行，对于与性能相关的工作总是有优势的。

此外，如今，让应用程序能够通过分布在多个核心上运行以实现扩展性变得至关重要，因为单线程性能往往达到了瓶颈。这种实现需要在应用程序的线程之间进行高效的通信，消除多线程程序中的资源消耗和其他常见问题。

需要指出的是，性能提升不仅仅来自调整软件方面。根据[Leiserson等人，2020]，未来潜在加速的另外两个主要来源是算法（尤其是针对机器学习等新问题域的算法）和简化的硬件设计。算法在应用程序的性能中显然发挥着重要作用，但本书不涵盖此主题。我们也不会讨论新硬件设计的主题，因为大多数情况下，软件开发人员必须处理现有的硬件。然而，了解现代CPU设计对于优化应用程序是重要的。

> "在摩尔时代后期，使代码运行快速，尤其是使其适应所运行的硬件，将变得越来越重要。"[Leiserson等人，2020]

本书中的方法论侧重于从应用程序中挤出最后一点性能。这种转变可以归属于表格1的第6行和第7行。这些改进类型通常不是很大，往往不超过10%。然而，不要低估10%的速度提升的重要性。对于在云配置中运行的大型分布式应用程序来说，这尤为重要。根据[Hennessy，2018]，2018年，谷歌在实际计算服务器上的支出与电力和冷却基础设施的支出大致相当。能源效率是一个非常重要的问题，通过优化软件可以改善能源效率。

> "在这样的规模下，理解性能特性变得至关重要，即使性能或利用率的微小改进也可以转化为巨大的成本节约。"[Kanev等人，2015]

## 1.2 谁需要性能调优？

性能工程在高性能计算（HPC）、云服务、高频交易（HFT）、游戏开发和其他对性能至关重要的领域中并不需要多加解释。例如，谷歌报告称，搜索速度慢2%导致每个用户的搜索量减少2%[^9]。对于Yahoo！来说，页面加载速度快400毫秒导致增加5-9%的流量[^10]。

[^9] 幻灯片由Marissa Mayer提供 - [链接](https://assets.en.oreilly.com/1/event/29/Keynote%20Presentation%202.pdf)
[^10] 幻灯片由Stoyan Stefanov提供 - [链接](https://www.slideshare.net/stoyan/dont-make-me-wait-or-buildinghighperformance-web-applications)
